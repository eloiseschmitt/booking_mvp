<section class="kitlast-content-section{% if section == 'services' %} is-active{% endif %}"
  data-section="services">
  <header class="kitlast-section-header">
    <div>
      <h2>Vos catégories & prestations</h2>
      <p class="kitlast-section-header__text">Organisez vos offres par catégorie et gardez une vue claire sur vos prestations.</p>
    </div>
  </header>

  <div class="kitlast-category-board">
    {% if categories %}
      <ul>
        {% for category in categories %}
          <li class="kitlast-category-card">
            <header class="kitlast-category-card__header">
              <h3>{{ category.name|upper }}</h3>
            </header>
            <ul class="kitlast-service-lines">
              {% if category.services.all %}
                {% for service in category.services.all %}
                  <li class="kitlast-service-line">
                    <div class="kitlast-service-line__info">
                      <span class="kitlast-service-line__name">{{ service.name }}</span>
                      <span class="kitlast-service-line__meta">
                        {% if service.price %}<span>{{ service.price }} €</span>{% endif %}
                        {% if service.duration_minutes %}<span>{{ service.duration_minutes }} min</span>{% endif %}
                      </span>
                    </div>
                    <div class="kitlast-service-line__actions">
                      <button type="button" class="kitlast-service-line__action kitlast-service-line__action--muted">Dupliquer</button>
                      <a href="{% url 'dashboard' %}?section=services&show=service-form&service_id={{ service.id }}" class="kitlast-service-line__action">Modifier</a>
                      <form method="post" action="{% url 'dashboard' %}?section=services" class="kitlast-service-line__form" onsubmit="return confirm('Supprimer cette prestation ?');">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="delete_service">
                        <input type="hidden" name="service_id" value="{{ service.id }}">
                        <button type="submit" class="kitlast-service-line__action kitlast-service-line__action--danger">Supprimer</button>
                      </form>
                    </div>
                  </li>
                {% endfor %}
              {% else %}
                <li class="kitlast-service-line kitlast-service-line--empty">Aucune prestation pour cette catégorie.</li>
              {% endif %}
            </ul>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="kitlast-empty">Aucune catégorie pour le moment. Ajoutez votre première catégorie pour structurer vos prestations.</p>
    {% endif %}
  </div>
</section>

{% include "accounts/components/modal_wrapper.html" with
  modal_data_attr='data-category-modal'
  modal_title='Ajouter une catégorie'
  modal_title_id='category-modal-title'
  modal_body_template='accounts/components/modal_category_form.html'
  modal_should_show=show_category_form or category_form.errors %}

{% include "accounts/components/modal_wrapper.html" with
  modal_data_attr='data-service-modal'
  modal_title=service_form.instance.pk|yesno:'Modifier une prestation,Ajouter une prestation'
  modal_title_id='service-modal-title'
  modal_body_template='accounts/components/modal_service_form.html'
  modal_should_show=show_service_form or service_form.errors %}
