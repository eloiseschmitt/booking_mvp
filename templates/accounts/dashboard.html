{% extends "base.html" %}
{% load static %}
{% block title %}Dashboard{% endblock %}
{% block head %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block scripts %}
{{ block.super }}
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}
{% block content %}
<div class="kitlast-dashboard-layout">
  <aside class="kitlast-dashboard-sidebar">
    <div class="kitlast-dashboard-sidebar__logo">
      <a href="{% url 'dashboard' %}?section=overview" data-section-target="overview">
        <img src="https://kitlast.com/wp-content/uploads/2025/08/kitlast-200-x-100-px.svg" alt="Kitlast" />
      </a>
    </div>
    <nav class="kitlast-dashboard-sidebar__nav" aria-label="Menu du tableau de bord">
      <ul>
        <li>
          <button type="button" class="kitlast-dashboard-sidebar__toggle" data-section-target="services"
            aria-expanded="{% if section == 'services' %}true{% else %}false{% endif %}"
            aria-controls="services-subnav">Gestion des prestations</button>
          <ul id="services-subnav" class="kitlast-dashboard-sidebar__subnav" {% if section != 'services' %} hidden{% endif %}>
            <li><a href="{% url 'dashboard' %}?section=services&show=category-form" data-action="show-category-form"
                data-modal-instant="true">Ajouter une catégorie</a></li>
            <li><a href="{% url 'dashboard' %}?section=services&show=service-form" data-action="show-service-form"
                data-modal-instant="true">Ajouter une prestation</a></li>
          </ul>
        </li>
        <li><a href="{% url 'dashboard' %}?section=planning" data-section-target="planning">Gestion des plannings</a>
        </li>
        <li><a href="{% url 'dashboard' %}?section=clients" data-section-target="clients">Gestion des clients</a></li>
      </ul>
    </nav>
  </aside>

  <section class="kitlast-dashboard-area">
    <div class="kitlast-dashboard">
      <div class="kitlast-dashboard__topbar">
        <form method="post" action="{% url 'logout' %}" class="kitlast-form-inline">
          {% csrf_token %}
          <button type="submit" class="kitlast-button">Se déconnecter</button>
        </form>
      </div>

      <div class="kitlast-dashboard-content" data-active-section="{{ section }}"
        data-show-category="{{ show_category_form|yesno:'true,false' }}"
        data-show-service="{{ show_service_form|yesno:'true,false' }}"
        data-week-offset="{{ week_offset }}">
        <section class="kitlast-content-section{% if section == 'overview' %} is-active{% endif %}"
          data-section="overview">
          <div class="kitlast-card kitlast-welcome-card">
            <h1 class="kitlast-dashboard__heading">Bonjour {{ request.user.first_name|default:request.user.email }} !
            </h1>
            <p class="kitlast-dashboard__subtitle">Heureux de vous revoir sur Kitlast. Gérez vos réservations et votre
              vitrine en toute simplicité.</p>
          </div>

          <div class="kitlast-dashboard-panels">
            <article class="kitlast-panel-card">
              <h2>Gestion des prestations</h2>
              <p class="kitlast-panel-card__text">Ajoutez, mettez à jour et mettez en avant vos prestations pour vos
                clients Kitlast.</p>
            </article>
            <article class="kitlast-panel-card">
              <h2>Gestion des plannings</h2>
              <p class="kitlast-panel-card__text">Organisez vos créneaux et synchronisez votre agenda avec les demandes
                reçues.</p>
            </article>
            <article class="kitlast-panel-card">
              <h2>Gestion des clients</h2>
              <p class="kitlast-panel-card__text">Suivez vos clients fidèles, leurs rendez-vous et vos échanges
                importants.</p>
            </article>
          </div>
        </section>

        {% include "accounts/dashboard_services.html" %}

        {% include "accounts/dashboard_planning.html" %}

        <section class="kitlast-content-section{% if section == 'clients' %} is-active{% endif %}"
          data-section="clients">
          <article class="kitlast-panel-card">
            <h2>Gestion des clients</h2>
            <p class="kitlast-panel-card__text">Retrouvez l'historique de vos clients, leurs préférences et facilitez
              vos échanges pour fidéliser votre communauté.</p>
          </article>
        </section>
      </div>
    </div>
  </section>
</div>

{% endblock %}
